{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/pbm19/Documents/teseracto/src/app/utils/data.ts"],"sourcesContent":["import { parse, isValid, format } from \"date-fns\";\r\nimport { es } from \"date-fns/locale\";\r\n\r\nexport const parseDates = (pathsArray: string[]): (string | null)[] => {\r\n  return pathsArray.map((entry) => {\r\n    const match =\r\n      entry.match(/(\\d{1,2})\\s+de\\s+([a-zA-ZñÑ]+)\\s+de\\s+(2025)/i) ||\r\n      entry.match(/(\\d{1,2})\\s+([a-zA-ZñÑ]+)\\s+(2025)/i);\r\n\r\n    if (match) {\r\n      const rawDate = `${match[1]} ${match[2]} ${match[3]}`;\r\n      let parsed = parse(rawDate, \"d MMMM yyyy\", new Date(), { locale: es });\r\n\r\n      if (!isValid(parsed)) {\r\n        parsed = parse(rawDate, \"d MMM yyyy\", new Date(), { locale: es });\r\n      }\r\n\r\n      if (isValid(parsed)) {\r\n        return format(parsed, \"dd/MM/yyyy\");\r\n      }\r\n    }\r\n\r\n    const slashDateMatch = entry.match(/(\\d{2})\\/(\\d{2})\\/(2025)/);\r\n    if (slashDateMatch) {\r\n      return `${slashDateMatch[1]}/${slashDateMatch[2]}/${slashDateMatch[3]}`;\r\n    }\r\n\r\n    return null; // Keep position if no match\r\n  });\r\n};\r\n\r\nexport const extractCurrencyValues = (pathsArray: string[]): string[] => {\r\n  const currencyRegex = /\\d{1,3}(?:\\.\\d{3})*(?:,\\d{2})?|\\d{4,}(?:,\\d{2})?/g;\r\n\r\n  const formatToCOP = (num: number): string => {\r\n    return num.toLocaleString(\"es-CO\", {\r\n      minimumFractionDigits: 0,\r\n      maximumFractionDigits: 2,\r\n    });\r\n  };\r\n\r\n  return pathsArray.map((str) => {\r\n    const matches = str.match(currencyRegex);\r\n    if (!matches) return \"\"; // Preserve position\r\n\r\n    const candidates = matches.filter((m) => {\r\n      const numericString = m.replace(/\\./g, \"\").replace(\",\", \".\");\r\n      const digitsOnly = m.replace(/[.,]/g, \"\");\r\n      if (digitsOnly.length > 9) return false;\r\n      const num = parseFloat(numericString);\r\n      return num >= 1000;\r\n    });\r\n\r\n    if (candidates.length === 0) return \"\"; // Preserve position\r\n\r\n    const sorted = candidates.sort((a, b) => {\r\n      const toNumber = (s: string) =>\r\n        parseFloat(s.replace(/\\./g, \"\").replace(\",\", \".\"));\r\n      return toNumber(b) - toNumber(a);\r\n    });\r\n\r\n    const top = sorted[0];\r\n    const topNum = parseFloat(top.replace(/\\./g, \"\").replace(\",\", \".\"));\r\n    return formatToCOP(topNum);\r\n  });\r\n};\r\n\r\nexport const combineDatesAndCurrency = (\r\n  datesArray: (string | null)[],\r\n  currencyArray: string[]\r\n) => {\r\n  const combinedArray = [];\r\n\r\n  for (let i = 0; i < datesArray.length; i++) {\r\n    combinedArray.push({\r\n      date: datesArray[i] ?? \"N/A\", // Use \"N/A\" if date is null\r\n      money: currencyArray[i] || \"N/A\", // Use \"N/A\" if money is empty string\r\n      id: i,\r\n    });\r\n  }\r\n\r\n  return combinedArray;\r\n};\r\n\r\nexport const isCombinedDataValid = (\r\n  combinedData: { date: string; money: string; id: number }[]\r\n): boolean => {\r\n  return combinedData.every(\r\n    (entry) =>\r\n      entry.date && entry.date !== \"N/A\" && entry.money && entry.money !== \"N/A\"\r\n  );\r\n};\r\n\r\nexport const findInvalidEntries = (\r\n  combinedData: { date: string; money: string; id: number }[]\r\n) => {\r\n  return combinedData.filter(\r\n    (entry) =>\r\n      !entry.date || entry.date === \"N/A\" ||\r\n      !entry.money || entry.money === \"N/A\"\r\n  );\r\n};\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 98, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/pbm19/Documents/teseracto/src/app/page.tsx"],"sourcesContent":["\"use client\";\r\nimport { ChangeEvent, useEffect, useState } from \"react\";\r\nimport { createWorker } from \"tesseract.js\";\r\nimport {\r\n  combineDatesAndCurrency,\r\n  extractCurrencyValues,\r\n  findInvalidEntries,\r\n  isCombinedDataValid,\r\n  parseDates,\r\n} from \"./utils/data\";\r\nimport { AppBarMenu } from \"./components/AppBarMenu\";\r\nimport { Box, Button, Typography } from \"@mui/material\";\r\nimport './page.css';\r\n\r\ninterface mainData {\r\n  date: string;\r\n  money: string;\r\n  id: number;\r\n}\r\n\r\nexport default function Home() {\r\n  const [files, setFiles] = useState<FileList>();\r\n  const [pathData, setPathData] = useState<mainData[]>([]);\r\n  const [sources, setSources] = useState<string[]>([\"\"]);\r\n\r\n  const handleChange = (event: ChangeEvent) => {\r\n    const target = event.target as HTMLInputElement;\r\n    const file = target.files as FileList;\r\n    if (file) {\r\n      setFiles(file);\r\n    }\r\n  };\r\n\r\n  const getImageText = async () => {\r\n    const worker = await createWorker(\"eng\");\r\n    const paths = [];\r\n    const sources = [\"\"];\r\n    if (files?.length) {\r\n      for (let i = 0; i < files?.length; ++i) {\r\n        const file = files[i];\r\n        const ret = await worker.recognize(file);\r\n        const ocrText = ret.data.text;\r\n        sources.push(URL.createObjectURL(file));\r\n        paths.push(ocrText);\r\n      }\r\n      sources.shift();\r\n      setSources(sources);\r\n      const expectedDatesArray = parseDates(paths);\r\n      const expectedCurrencyArray = extractCurrencyValues(paths);\r\n      const result = combineDatesAndCurrency(\r\n        expectedDatesArray,\r\n        expectedCurrencyArray\r\n      );\r\n\r\n      if (!isCombinedDataValid(result)) {\r\n        console.warn(\"Some entries are missing date or currency. Prompt user.\");\r\n        console.log(findInvalidEntries(result));\r\n      } else {\r\n        console.log(\"All good. Proceed with:\", result);\r\n      }\r\n\r\n      setPathData(result);\r\n    }\r\n    await worker.terminate();\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (files?.length !== 0) {\r\n      getImageText();\r\n    }\r\n  }, [files]);\r\n\r\n  return (\r\n    <>\r\n      <AppBarMenu />\r\n      <Box className=\"mainBox\">\r\n        <section\r\n          style={{\r\n            display: \"flex\",\r\n            flexDirection: \"column\",\r\n            width: \"50%\",\r\n            alignItems: \"center\",\r\n          }}\r\n        >\r\n          <Typography\r\n            variant=\"h3\"\r\n            sx={{\r\n              color: \"#2E2E2E\",\r\n              fontWeight: \"bold\",\r\n            }}\r\n          >\r\n            Titulo!\r\n          </Typography>\r\n          <Typography\r\n            variant=\"h6\"\r\n            sx={{\r\n              color: \"#2E2E2E\",\r\n            }}\r\n          >\r\n            Anim aute id magna aliqua ad ad non deserunt sunt. Qui irure qui\r\n            lorem cupidatat commodo. Elit sunt amet fugiat veniam occaecat.\r\n          </Typography>\r\n          <Box sx={{ display: \"flex\", flexDirection: \"row\" }}>\r\n            <Button\r\n              variant=\"contained\"\r\n              sx={{ background: \"#464033\", textTransform: \"none\" }}\r\n            >\r\n              Empecemos\r\n            </Button>\r\n            <Button sx={{ color: \"#2E2E2E\", textTransform: \"none\" }}>\r\n              Más info\r\n            </Button>\r\n          </Box>\r\n        </section>\r\n      </Box>\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;;;;;;AAQA;AAAA;AAAA;;;AAXA;;;;;;;AAoBe,SAAS;;IACtB,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD;IACjC,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAc,EAAE;IACvD,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAY;QAAC;KAAG;IAErD,MAAM,eAAe,CAAC;QACpB,MAAM,SAAS,MAAM,MAAM;QAC3B,MAAM,OAAO,OAAO,KAAK;QACzB,IAAI,MAAM;YACR,SAAS;QACX;IACF;IAEA,MAAM,eAAe;QACnB,MAAM,SAAS,MAAM,CAAA,GAAA,kJAAA,CAAA,eAAY,AAAD,EAAE;QAClC,MAAM,QAAQ,EAAE;QAChB,MAAM,UAAU;YAAC;SAAG;QACpB,IAAI,OAAO,QAAQ;YACjB,IAAK,IAAI,IAAI,GAAG,IAAI,OAAO,QAAQ,EAAE,EAAG;gBACtC,MAAM,OAAO,KAAK,CAAC,EAAE;gBACrB,MAAM,MAAM,MAAM,OAAO,SAAS,CAAC;gBACnC,MAAM,UAAU,IAAI,IAAI,CAAC,IAAI;gBAC7B,QAAQ,IAAI,CAAC,IAAI,eAAe,CAAC;gBACjC,MAAM,IAAI,CAAC;YACb;YACA,QAAQ,KAAK;YACb,WAAW;YACX,MAAM,qBAAqB,CAAA,GAAA,8HAAA,CAAA,aAAU,AAAD,EAAE;YACtC,MAAM,wBAAwB,CAAA,GAAA,8HAAA,CAAA,wBAAqB,AAAD,EAAE;YACpD,MAAM,SAAS,CAAA,GAAA,8HAAA,CAAA,0BAAuB,AAAD,EACnC,oBACA;YAGF,IAAI,CAAC,CAAA,GAAA,8HAAA,CAAA,sBAAmB,AAAD,EAAE,SAAS;gBAChC,QAAQ,IAAI,CAAC;gBACb,QAAQ,GAAG,CAAC,CAAA,GAAA,8HAAA,CAAA,qBAAkB,AAAD,EAAE;YACjC,OAAO;gBACL,QAAQ,GAAG,CAAC,2BAA2B;YACzC;YAEA,YAAY;QACd;QACA,MAAM,OAAO,SAAS;IACxB;IAEA,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;0BAAE;YACR,IAAI,OAAO,WAAW,GAAG;gBACvB;YACF;QACF;yBAAG;QAAC;KAAM;IAEV,qBACE;;0BACE,6LAAC;;;;;0BACD,6LAAC,2LAAA,CAAA,MAAG;gBAAC,WAAU;0BACb,cAAA,6LAAC;oBACC,OAAO;wBACL,SAAS;wBACT,eAAe;wBACf,OAAO;wBACP,YAAY;oBACd;;sCAEA,6LAAC,gNAAA,CAAA,aAAU;4BACT,SAAQ;4BACR,IAAI;gCACF,OAAO;gCACP,YAAY;4BACd;sCACD;;;;;;sCAGD,6LAAC,gNAAA,CAAA,aAAU;4BACT,SAAQ;4BACR,IAAI;gCACF,OAAO;4BACT;sCACD;;;;;;sCAID,6LAAC,2LAAA,CAAA,MAAG;4BAAC,IAAI;gCAAE,SAAS;gCAAQ,eAAe;4BAAM;;8CAC/C,6LAAC,oMAAA,CAAA,SAAM;oCACL,SAAQ;oCACR,IAAI;wCAAE,YAAY;wCAAW,eAAe;oCAAO;8CACpD;;;;;;8CAGD,6LAAC,oMAAA,CAAA,SAAM;oCAAC,IAAI;wCAAE,OAAO;wCAAW,eAAe;oCAAO;8CAAG;;;;;;;;;;;;;;;;;;;;;;;;;AAQrE;GAjGwB;KAAA","debugId":null}}]
}